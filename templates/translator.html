{% extends 'base.html' %}
{% load static %}


{% block content%}
<body>
    <main id="main" class="main">
        <div class="pagetitle">
            <h1>Translator</h1>
            <nav>
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% static 'index' %}">Home</a></li>
                    <li class="breadcrumb-item active">Translator</li>
                </ol>
            </nav>
        </div><!-- End Page Title -->

        <section class="section dashboard">
            <div class="container">

                <!-- detection and selection of Language section -->
                <form method="POST" action="{% url 'translator' %}">
                    {% csrf_token %}
                    <!-- languageDropdown -->
                    <div class="col-12 form-control hstack mb-1">
                        <!-- Source Language Dropdown -->
                        <div class="col d-flex justify-content-between">
                            <div class="input-group-prepend flex-grow-1">
                                <div class="dropdown ">
                                    <select class="form-select border-0 btn-light form-select-md" id="sourceLangInput"
                                        aria-label="Select Source Language" onchange="updateHiddenSource()">
                                        <option selected disabled>Select Source Language</option>
                                        <option value="en">English</option>
                                        <option value="ja">Japanese</option>
                                        <option value="zh">Chinese</option>
                                    </select>
                                    <input type="hidden" id="sourceLangInputHidden" value="workingggggk"
                                        name="source_lang">
                                </div>
                            </div>
                        </div>

                        <div class="vr d-flex align-items-center"></div>

                        <!-- Target Language Dropdown -->
                        <div class="col d-flex justify-content-between">
                            <div class="input-group-prepend flex-grow-1">
                                <div class="dropdown">
                                    <select class="form-select border-0 btn-light form-select-md" id="targetLangInput"
                                        aria-label="Select Source Language" onchange="updateHiddenTarget()">
                                        <option selected value="en">English</option>
                                        <option value="ja">Japanese</option>
                                        <option value="zh">Chinese</option>
                                    </select>
                                    <input type="hidden" id="targetLangInputHidden"
                                        value="returning only the value of the hidden" name="target_lang">
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="w-100"></div>

                    <!-- Input and Output Textareas -->
                    <div class="col-12  form-control hstack gap-0">
                        <div class="col">
                            <div class="form-group">
                                <textarea class="form-control border-0" rows="8" placeholder="Enter text"
                                    name="input_text" id="inputText"></textarea>
                            </div>
                        </div>

                        <div class="vr d-flex align-items-center"></div>

                        <div class="col">
                            <div class="form-group">
                                <textarea class="form-control border-0" rows="8" placeholder="Output will go here..."
                                    id="outputText"></textarea>
                            </div>
                        </div>
                        <p id="outputTextDisplay">{{ translated_text }}</p>
                    </div>

                    <div class="col-12 mt-3" style="text-align: left" >
                        <button type="submit" class="btn btn-primary">Translate Text</button>
                    </div>

                </form>
            </div>
        </section>
    </main><!-- End #main -->
</body>
{% endblock content%}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
        var translatedText = "{{ translated_text }}";  // Get the translated text from Django template context
        document.getElementById('outputTextDisplay').innerText = translatedText;               
        
        // Example of setting translated text
        const translatedText = "Translated text here"; // Replace with actual translated text
        document.getElementById('outputText').innerText = translatedText;

        // Get the source and target language select elements
        const sourceLangSelect = document.getElementById('sourceLangInput');
        const targetLangSelect = document.getElementById('targetLangInput');
        const sourceLangHidden = document.getElementById('sourceLangInputHidden');
        const targetLangHidden = document.getElementById('targetLangInputHidden');

        function updateHiddenSource() {
            var selectedSource = document.getElementById('sourceLangInput').value;
            sourceLangHidden.value = selectedSource;  // Update hidden field with source language value
            console.log(sourceLangHidden)
        }
        function updateHiddenTarget() {
            var selectedTarget = document.getElementById('targetLangInput').value;
            targetLangHidden.value = selectedTarget;  // Update hidden field with target language value
            console.log(targetLangHidden)
        }
    });

</script>
{% endblock scripts %}
